[gd_scene format=4 uid="uid://dqxl4xm2m55i6"]

[ext_resource type="Script" uid="uid://cddu6i3h81t0s" path="res://Levels/Scripts/level.gd" id="1_22ele"]
[ext_resource type="PackedScene" uid="uid://liurpj8sy87g" path="res://TileMaps/grass-01.tscn" id="1_vbl6q"]
[ext_resource type="PackedScene" uid="uid://bn6m1d1rmbcu5" path="res://Levels/player_spawn.tscn" id="2_chooo"]
[ext_resource type="PackedScene" uid="uid://c325f2ae47ebh" path="res://Levels/level_transition.tscn" id="4_4t7i1"]
[ext_resource type="PackedScene" uid="uid://dwmq3idbsxhoh" path="res://Props/Plants/plant.tscn" id="5_pwydo"]
[ext_resource type="PackedScene" uid="uid://b6ctd7n60iuvm" path="res://Items/item_pickup/item_pickup.tscn" id="6_xhij5"]
[ext_resource type="Resource" uid="uid://bedqtc5g48wpg" path="res://Items/gem.tres" id="7_th3kk"]
[ext_resource type="Resource" uid="uid://bpfit3tnwae6r" path="res://Items/potion.tres" id="8_th3kk"]
[ext_resource type="PackedScene" uid="uid://be880rni4jo7s" path="res://Enemies/Slime/Slime.tscn" id="9_b60gt"]
[ext_resource type="PackedScene" uid="uid://dx6qiy1snmt5a" path="res://Interactables/TreasureChest/treasure-chest.tscn" id="10_f2d14"]
[ext_resource type="AudioStream" uid="uid://dpm2517mdalxs" path="res://Levels/Music/example_music_01.ogg" id="11_an23e"]
[ext_resource type="PackedScene" uid="uid://d0xtl5nafmkfl" path="res://NPC/npc.tscn" id="12_c2gse"]
[ext_resource type="Resource" uid="uid://didkq3x0ho8hy" path="res://NPC/00_NPCs/npc_01.tres" id="13_qqqph"]
[ext_resource type="PackedScene" uid="uid://p723lrsa8j5g" path="res://NPC/npc_behavior_wander.tscn" id="13_uv5ft"]
[ext_resource type="PackedScene" uid="uid://cirvelp6xk5e6" path="res://NPC/npc_behavior_patrol.tscn" id="15_t4onu"]
[ext_resource type="PackedScene" uid="uid://3uncbihj24t" path="res://Interactables/Dialog/DialogInteraction.tscn" id="15_vg1n0"]
[ext_resource type="Script" uid="uid://bbpr4a163b3pm" path="res://Interactables/Dialog/Scripts/dialog_text.gd" id="16_2l6ck"]
[ext_resource type="PackedScene" uid="uid://ccsminw7qsdb2" path="res://NPC/patrol_location.tscn" id="16_vg1n0"]
[ext_resource type="Resource" uid="uid://kgmaj2lxqcvk" path="res://NPC/00_NPCs/npc_hero.tres" id="17_rbd2o"]
[ext_resource type="Resource" uid="uid://dl37sx7ja1crx" path="res://NPC/00_NPCs/npc_02.tres" id="18_suexf"]
[ext_resource type="Script" uid="uid://bppuueavjs188" path="res://Interactables/Dialog/Scripts/dialog_choice.gd" id="21_ao3f7"]
[ext_resource type="Script" uid="uid://dxq1ime3bskty" path="res://Interactables/Dialog/Scripts/dialog_branch.gd" id="22_t1cxi"]
[ext_resource type="PackedScene" uid="uid://2euk4sitg7jb" path="res://Props/Pots/Pot.tscn" id="23_8k3ch"]
[ext_resource type="PackedScene" uid="uid://x7mqxn0cs75f" path="res://Quests/utility_nodes/quest_advance_trigger.tscn" id="23_mpmqi"]
[ext_resource type="PackedScene" uid="uid://dnete4104lbhm" path="res://Quests/utility_nodes/quest_activated_switch.tscn" id="25_hvqxe"]
[ext_resource type="Resource" uid="uid://cdx7o4ti656t" path="res://Quests/recover_lost_flute.tres" id="25_mpmqi"]

[sub_resource type="GDScript" id="GDScript_hvqxe"]
script/source = "extends Node

@onready var quest_advance_trigger: QuestAdvanceTrigger = $\"..\"

func _ready() -> void:
	quest_advance_trigger.advanced.connect( quest_complete )
	pass

func quest_complete():
	PlayerManager.INVENTORY_DATA.use_item( load(\"res://Items/magical_flute.tres\") )
	pass
"

[node name="01" type="Node2D" unique_id=148797791]
script = ExtResource("1_22ele")
music = ExtResource("11_an23e")

[node name="Grass01" parent="." unique_id=2117602614 instance=ExtResource("1_vbl6q")]
tile_map_data = PackedByteArray("AAD/////AQAOAAUAAAD//wAAAQAOAAYAAAAAAP//AQAKAAYAAAAAAAAAAQAKAAcAAAABAP//AQALAAUAAAABAAAAAQAMAAcAAAD//wEAAQAOAAUAAAD//wIAAQAOAAYAAAAAAAEAAQACAAIAAAAAAAIAAQACAAMAAAABAAEAAQADAAIAAAABAAIAAQADAAMAAAD//wMAAQAOAAUAAAD//wQAAQAOAAYAAAAAAAMAAQACAAIAAAAAAAQAAQACAAMAAAABAAMAAQADAAIAAAABAAQAAQADAAMAAAD//wUAAQAOAAUAAAD//wYAAQAOAAUAAAAAAAUAAQACAAIAAAAAAAYAAQACAAMAAAABAAUAAQADAAIAAAABAAYAAQADAAMAAAD//wgAAQAOAAUAAAAAAAcAAQAKAAQAAAABAAcAAQANAAQAAAABAAgAAQADAAMAAAACAP//AQAMAAUAAAACAAAAAQANAAcAAAADAP//AQANAAUAAAADAAAAAQALAAcAAAAEAP//AQALAAUAAAAEAAAAAQAMAAcAAAACAAEAAQABAAIAAAACAAIAAQABAAMAAAADAAEAAQACAAIAAAADAAIAAQACAAMAAAAEAAEAAQADAAIAAAAEAAIAAQADAAMAAAACAAMAAQABAAIAAAACAAQAAQABAAMAAAADAAMAAQACAAIAAAADAAQAAQAAAAAAAAAEAAMAAQADAAIAAAAEAAQAAQADAAMAAAACAAUAAQABAAIAAAACAAYAAQABAAMAAAADAAUAAQACAAIAAAADAAYAAQACAAMAAAAEAAUAAQADAAIAAAAEAAYAAQADAAMAAAACAAcAAQALAAQAAAACAAgAAQABAAMAAAADAAcAAQAMAAQAAAADAAgAAQACAAMAAAAEAAcAAQANAAQAAAAEAAgAAQADAAMAAAAFAP//AQAMAAUAAAAFAAAAAQANAAcAAAAGAP//AQANAAUAAAAGAAAAAQALAAcAAAAHAP//AQALAAUAAAAHAAAAAQAMAAcAAAAFAAEAAQABAAIAAAAFAAIAAQABAAMAAAAGAAEAAQACAAIAAAAGAAIAAQACAAMAAAAHAAEAAQADAAIAAAAHAAIAAQADAAMAAAAFAAMAAQABAAIAAAAFAAQAAQABAAMAAAAGAAMAAQAAAAAAAAAGAAQAAQACAAMAAAAHAAMAAQADAAIAAAAHAAQAAQADAAMAAAAFAAUAAQABAAIAAAAFAAYAAQABAAMAAAAGAAUAAQACAAIAAAAGAAYAAQACAAMAAAAHAAUAAQADAAIAAAAHAAYAAQADAAMAAAAFAAcAAQALAAQAAAAFAAgAAQABAAMAAAAGAAcAAQAMAAQAAAAGAAgAAQACAAMAAAAHAAcAAQANAAQAAAAHAAgAAQADAAMAAAAIAP//AQAMAAUAAAAIAAAAAQANAAcAAAAJAP//AQANAAUAAAAJAAAAAQALAAcAAAAKAP//AQALAAUAAAAKAAAAAQAMAAcAAAAIAAEAAQABAAIAAAAIAAIAAQABAAMAAAAJAAEAAQACAAIAAAAJAAIAAQACAAMAAAAKAAEAAQADAAIAAAAKAAIAAQADAAMAAAAIAAMAAQABAAIAAAAIAAQAAQABAAMAAAAJAAMAAQACAAIAAAAJAAQAAQACAAMAAAAKAAMAAQADAAIAAAAKAAQAAQADAAMAAAAIAAUAAQABAAIAAAAIAAYAAQABAAMAAAAJAAUAAQACAAIAAAAJAAYAAQACAAMAAAAKAAUAAQADAAIAAAAKAAYAAQADAAMAAAAIAAcAAQALAAQAAAAIAAgAAQABAAMAAAAJAAcAAQAMAAQAAAAJAAgAAQACAAMAAAAKAAcAAQANAAQAAAAKAAgAAQADAAMAAAALAP//AQAMAAUAAAALAAAAAQANAAcAAAAMAP//AQANAAUAAAAMAAAAAQAMAAcAAAANAP//AQACAAIAAAANAAAAAQANAAcAAAALAAEAAQABAAIAAAALAAIAAQABAAMAAAAMAAEAAQACAAIAAAAMAAIAAQACAAMAAAANAAEAAQADAAIAAAALAAMAAQABAAIAAAALAAQAAQABAAMAAAAMAAMAAQACAAIAAAAMAAQAAQACAAMAAAANAAMAAQADAAIAAAANAAQAAQADAAMAAAALAAUAAQABAAIAAAALAAYAAQABAAMAAAAMAAUAAQACAAIAAAAMAAYAAQACAAMAAAANAAUAAQADAAIAAAANAAYAAQADAAMAAAALAAcAAQALAAQAAAALAAgAAQABAAMAAAAMAAcAAQAMAAQAAAAMAAgAAQACAAMAAAANAAcAAQANAAQAAAANAAgAAQADAAMAAAAOAP//AQAOAAYAAAAOAAAAAQAOAAcAAAAPAP//AQAKAAUAAAAPAAAAAQAKAAUAAAAOAAEAAQABAAIAAAAOAAIAAQABAAIAAAAPAAEAAQAKAAYAAAAPAAIAAQAKAAUAAAAOAAMAAQABAAIAAAAOAAQAAQABAAIAAAAPAAMAAQAKAAcAAAAPAAQAAQABAAIAAAAPAAYAAQAKAAQAAAAOAAgAAQAOAAUAAAAPAAcAAQAKAAUAAAAPAAgAAQAKAAUAAAAOAAcAAQAOAAQAAAAOAAUAAQABAAIAAAAOAAYAAQACAAIAAAD//wcAAQAOAAYAAAAAAAgAAQAKAAUAAAAPAAUAAQABAAMAAAANAAIAAQADAAMAAAA=")

[node name="PlayerSpawn" parent="." unique_id=793238168 instance=ExtResource("2_chooo")]
position = Vector2(434, 163)

[node name="LevelTransition" parent="." unique_id=1606747522 instance=ExtResource("4_4t7i1")]
position = Vector2(512, 160)
level = "uid://dbequpfyc37bc"
side = 1

[node name="Plant" parent="." unique_id=1673975202 instance=ExtResource("5_pwydo")]
position = Vector2(354, 74)

[node name="ItemPickup" parent="." unique_id=2026577212 instance=ExtResource("6_xhij5")]
position = Vector2(309.78247, 151.38315)
item_data = ExtResource("7_th3kk")

[node name="ItemPickup2" parent="." unique_id=775650957 instance=ExtResource("6_xhij5")]
position = Vector2(311, 186.94206)
item_data = ExtResource("8_th3kk")

[node name="ItemPickup3" parent="." unique_id=991493168 instance=ExtResource("6_xhij5")]
position = Vector2(390.9964, 259.02722)
item_data = ExtResource("7_th3kk")

[node name="Slime" parent="." unique_id=919455436 instance=ExtResource("9_b60gt")]
position = Vector2(34, 84)

[node name="TreasureChest" parent="." unique_id=380576144 instance=ExtResource("10_f2d14")]
position = Vector2(428, 79)
item_data = ExtResource("7_th3kk")
quantity = 3

[node name="TreasureChest2" parent="." unique_id=807482638 instance=ExtResource("10_f2d14")]
position = Vector2(271, 78)
quantity = 0

[node name="NPC" parent="." unique_id=1746412371 instance=ExtResource("12_c2gse")]
position = Vector2(224, 153)
npc_resource = ExtResource("13_qqqph")

[node name="NPCBehaviorWander" parent="NPC" unique_id=2085500851 instance=ExtResource("13_uv5ft")]

[node name="DialogInteraction" parent="NPC" unique_id=580462823 instance=ExtResource("15_vg1n0")]

[node name="DialogText" type="Node" parent="NPC/DialogInteraction" unique_id=1019644669]
script = ExtResource("16_2l6ck")
text = "
Hi, [b]Hero[/b] is that you?"
npc_info = ExtResource("13_qqqph")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="DialogText2" type="Node" parent="NPC/DialogInteraction" unique_id=899273229]
script = ExtResource("16_2l6ck")
text = "
[wave]Heck yeah it's me![/wave]"
npc_info = ExtResource("17_rbd2o")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="DialogText3" type="Node" parent="NPC/DialogInteraction" unique_id=228893890]
script = ExtResource("16_2l6ck")
text = "Nice Bro!
Happy to have a hero!
"
npc_info = ExtResource("13_qqqph")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="NPC_Nero" parent="." unique_id=1288066685 instance=ExtResource("12_c2gse")]
position = Vector2(74, 165)
npc_resource = ExtResource("18_suexf")

[node name="NPCPatrol" parent="NPC_Nero" unique_id=1916161808 instance=ExtResource("15_t4onu")]

[node name="PatrolLocation" parent="NPC_Nero/NPCPatrol" unique_id=1950033527 instance=ExtResource("16_vg1n0")]
modulate = Color(1, 0, 0, 1)
position = Vector2(0, 1)

[node name="PatrolLocation2" parent="NPC_Nero/NPCPatrol" unique_id=1932311995 instance=ExtResource("16_vg1n0")]
modulate = Color(1, 1, 0, 1)
position = Vector2(85, 1)
wait_time = 1.0

[node name="PatrolLocation3" parent="NPC_Nero/NPCPatrol" unique_id=308499096 instance=ExtResource("16_vg1n0")]
modulate = Color(0, 1, 0, 1)
position = Vector2(87, -98)
wait_time = 1.0

[node name="PatrolLocation4" parent="NPC_Nero/NPCPatrol" unique_id=1440408959 instance=ExtResource("16_vg1n0")]
modulate = Color(0, 0, 1, 1)
position = Vector2(-1, -98)
wait_time = 1.0

[node name="QuestActivatedSwitch" parent="NPC_Nero" unique_id=1534198243 instance=ExtResource("25_hvqxe")]
position = Vector2(-2, -27)
remove_when_activated = true
react_to_global_signal = true
linked_quest = ExtResource("25_mpmqi")
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Checking if player has quest"

[node name="DialogInteraction" parent="NPC_Nero/QuestActivatedSwitch" unique_id=365682414 instance=ExtResource("15_vg1n0")]
position = Vector2(2, 27)

[node name="DialogText" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction" unique_id=907650038]
script = ExtResource("16_2l6ck")
text = "Yo! Hero! Will you help retreive my magical flute form the dark dungeon?"
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="DialogChoice" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction" unique_id=1744377225]
script = ExtResource("21_ao3f7")
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bppuueavjs188"

[node name="DialogBranch" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice" unique_id=21925310]
script = ExtResource("22_t1cxi")
text = "Yes, Count on it!"
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://dxq1ime3bskty"

[node name="QuestAdvanceTrigger" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch" unique_id=1016245066 instance=ExtResource("23_mpmqi")]
position = Vector2(75, 138)
linked_quest = ExtResource("25_mpmqi")
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Step: 0 - N/A
Complete: false"

[node name="DialogText" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch" unique_id=562601580]
script = ExtResource("16_2l6ck")
text = "Thank you dear here! You are true specimen!"
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="DialogText2" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch" unique_id=233607438]
script = ExtResource("16_2l6ck")
text = "Oh, and be careful of the evil wizard who lunks in the dungeon!"
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="DialogBranch2" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice" unique_id=1283572679]
script = ExtResource("22_t1cxi")
text = "NO!"
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://dxq1ime3bskty"

[node name="DialogText" type="Node" parent="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch2" unique_id=741696527]
script = ExtResource("16_2l6ck")
text = "Greez! Some lousy hero you are..."
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="QuestActivatedSwitch3" parent="NPC_Nero" unique_id=1534430216 instance=ExtResource("25_hvqxe")]
check_type = 3
remove_when_activated = true
free_when_activated = true
react_to_global_signal = true
linked_quest = ExtResource("25_mpmqi")
quest_complete = true
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Checking if quest has completed"

[node name="QuestActivatedSwitch2" parent="NPC_Nero/QuestActivatedSwitch3" unique_id=1874037714 instance=ExtResource("25_hvqxe")]
react_to_global_signal = true
linked_quest = ExtResource("25_mpmqi")
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Checking if player has quest"

[node name="QuestActivatedSwitch" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2" unique_id=88863583 instance=ExtResource("25_hvqxe")]
position = Vector2(-2, -27)
check_type = 2
remove_when_activated = true
react_to_global_signal = true
linked_quest = ExtResource("25_mpmqi")
quest_step = 3
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Checking if player is on step: return the magical flute to nero"

[node name="DialogInteraction" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch" unique_id=319956211 instance=ExtResource("15_vg1n0")]
position = Vector2(2, 27)

[node name="DialogText" type="Node" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch/DialogInteraction" unique_id=1323747727]
script = ExtResource("16_2l6ck")
text = "Thank you Hero! I lost my flute in the cave to the north."
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="QuestActivatedSwitch2" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2" unique_id=1971727161 instance=ExtResource("25_hvqxe")]
check_type = 2
react_to_global_signal = true
linked_quest = ExtResource("25_mpmqi")
quest_step = 3
quest_complete = true
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Checking if player is on step: return the magical flute to nero"

[node name="DialogInteraction" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2" unique_id=443108311 instance=ExtResource("15_vg1n0")]

[node name="DialogText" type="Node" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2/DialogInteraction" unique_id=1678134605]
script = ExtResource("16_2l6ck")
text = "Wow you found my flute!
It's not much, but here's a reward."
npc_info = ExtResource("18_suexf")
metadata/_custom_type_script = "uid://bbpr4a163b3pm"

[node name="QuestAdvanceTrigger" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2/DialogInteraction" unique_id=495257 instance=ExtResource("23_mpmqi")]
linked_quest = ExtResource("25_mpmqi")
quest_step = 3
quest_complete = true
settings_summary = "UPDATE QUEST:
Quest: Recover Lost Magical Flute
Step: 3 - return the magical flute to nero
Complete: true"

[node name="Node" type="Node" parent="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2/DialogInteraction/QuestAdvanceTrigger" unique_id=1001974864]
script = SubResource("GDScript_hvqxe")

[node name="Pot" parent="." unique_id=575496767 instance=ExtResource("23_8k3ch")]
position = Vector2(377, 157)

[connection signal="selected" from="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch" to="NPC_Nero/QuestActivatedSwitch/DialogInteraction/DialogChoice/DialogBranch/QuestAdvanceTrigger" method="advance_quest"]
[connection signal="finished" from="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2/DialogInteraction" to="NPC_Nero/QuestActivatedSwitch3/QuestActivatedSwitch2/QuestActivatedSwitch2/DialogInteraction/QuestAdvanceTrigger" method="advance_quest"]
